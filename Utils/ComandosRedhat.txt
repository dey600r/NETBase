
https://www.okd.io/crc/
https://console.redhat.com/openshift/create/local
https://developers.redhat.com/content-gateway/file/pub/openshift-v4/clients/crc/2.58.0/crc-windows-installer.zip

Configuration:
    1 - crc setup
        - Pull secret: {"auths":{"cloud.openshift.com":{"auth":"b3BlbnNoaWZ0LXJlbGVhc2UtZGV2K29jbV9hY2Nlc3NfZWE3ZDRiZDgxODQ3NDg2ZTk5ODQ2M2QxMjc2MmQ0MWY6R0lTVjNPU1hGVzdBR1ZaNUhIODlIWlJHQkcwVEJKQlpESUJHTklPQ0NRSTFCSk5BRlhUOUtWRTJWRFdCSVM3TA==","email":"dey125r@gmail.com"},"quay.io":{"auth":"b3BlbnNoaWZ0LXJlbGVhc2UtZGV2K29jbV9hY2Nlc3NfZWE3ZDRiZDgxODQ3NDg2ZTk5ODQ2M2QxMjc2MmQ0MWY6R0lTVjNPU1hGVzdBR1ZaNUhIODlIWlJHQkcwVEJKQlpESUJHTklPQ0NRSTFCSk5BRlhUOUtWRTJWRFdCSVM3TA==","email":"dey125r@gmail.com"},"registry.connect.redhat.com":{"auth":"fHVoYy1wb29sLWQwYTQxZjQxLWUwOTctNDIwNi1iNzA4LWIxMjEwNDI3YTQxZTpleUpoYkdjaU9pSlNVelV4TWlKOS5leUp6ZFdJaU9pSXdObUprWVRaaU5EVXpPV1UwWkdZek9HRXdaR1F6TVdaak5HSmpNamhqTmlKOS5YX0N6MGZiN19WdHNvcHhhYlhLVU1GdjR5Rmt1RnlNNU95N1ZGWV9uZXZCOXBOOGMxOUpEZEkwRlhTX3o5eFNYRGtfMWFYaUg5U1AyY1JGZUpWMHJLRms1TkVSNHR1X0t1NzlVTWlDSmMyMFdkblpHbG9JRU1XdXZxUXJjOTRtU3pEMnNtMTRvbWYzbVBFLXlGek4waUlqNHdpQmN1Z2dYNmtJZkVPakhnUmhKSWpZZUNUZWJYYkViV1ZUa09qRDZkNVREOVczVzdvR2tXU2NSU2h4YkRuREVIaFVFRmRxeEs0endnWnRwZ0Z0SUNmczB5LTZHVGppZWM0MmFzVFBWMmZmWG50S2hoRG1ZWEFfNDdSdV9CSzI1ZDV5cmI3a0Q3N0ZVcjNINmJoRnk0VlZkOVM0cldZNFhDa2hEdFE0SEk1bUEwTlZBNDItZGd2aXh2MlRZWS1XTUwzY0o4aUNoQnM1ZHdzTTR5NGk0Q2c2QTQ1Tk9WaEhXaVRGLWlYam9fdVo1dHE3RzItd3RYeTl1OVBORS1TSHVvazZMekY4bC1vY09PVk5TZE9tT3kwQTM4aDd5T0xVVDFXb0hnLVJXOUd3UU4wb3RlQ056SnQ0Yzk5NlRjbUp1a1FBOXNLaWVnMVlDbWJINXpBTlMwUjBSOGVWSk9oWG1ja2ctRnp1eFFDX2xJdXVQVEJoUG1qOUl5NmloVUJ0enduQWJkT0I0SDNuaVgyTVViZi1HU1hpYnFjMUtRR2FvdmMxM0RNYV9xQlA3cUZrb0hpbWVMTHFnWEVVVGNwcHdpNjBJLU1YamlpOVdRWGJwWFJWWVJ2V2hSN1R1cHlrdEZXMEM5LXFUMkZieWNkMVpsNktVc2psdXFpdGQ1bW84YkFYRFhtWTdfZHNsSlJCaE9Bbw==","email":"dey125r@gmail.com"},"registry.redhat.io":{"auth":"fHVoYy1wb29sLWQwYTQxZjQxLWUwOTctNDIwNi1iNzA4LWIxMjEwNDI3YTQxZTpleUpoYkdjaU9pSlNVelV4TWlKOS5leUp6ZFdJaU9pSXdObUprWVRaaU5EVXpPV1UwWkdZek9HRXdaR1F6TVdaak5HSmpNamhqTmlKOS5YX0N6MGZiN19WdHNvcHhhYlhLVU1GdjR5Rmt1RnlNNU95N1ZGWV9uZXZCOXBOOGMxOUpEZEkwRlhTX3o5eFNYRGtfMWFYaUg5U1AyY1JGZUpWMHJLRms1TkVSNHR1X0t1NzlVTWlDSmMyMFdkblpHbG9JRU1XdXZxUXJjOTRtU3pEMnNtMTRvbWYzbVBFLXlGek4waUlqNHdpQmN1Z2dYNmtJZkVPakhnUmhKSWpZZUNUZWJYYkViV1ZUa09qRDZkNVREOVczVzdvR2tXU2NSU2h4YkRuREVIaFVFRmRxeEs0endnWnRwZ0Z0SUNmczB5LTZHVGppZWM0MmFzVFBWMmZmWG50S2hoRG1ZWEFfNDdSdV9CSzI1ZDV5cmI3a0Q3N0ZVcjNINmJoRnk0VlZkOVM0cldZNFhDa2hEdFE0SEk1bUEwTlZBNDItZGd2aXh2MlRZWS1XTUwzY0o4aUNoQnM1ZHdzTTR5NGk0Q2c2QTQ1Tk9WaEhXaVRGLWlYam9fdVo1dHE3RzItd3RYeTl1OVBORS1TSHVvazZMekY4bC1vY09PVk5TZE9tT3kwQTM4aDd5T0xVVDFXb0hnLVJXOUd3UU4wb3RlQ056SnQ0Yzk5NlRjbUp1a1FBOXNLaWVnMVlDbWJINXpBTlMwUjBSOGVWSk9oWG1ja2ctRnp1eFFDX2xJdXVQVEJoUG1qOUl5NmloVUJ0enduQWJkT0I0SDNuaVgyTVViZi1HU1hpYnFjMUtRR2FvdmMxM0RNYV9xQlA3cUZrb0hpbWVMTHFnWEVVVGNwcHdpNjBJLU1YamlpOVdRWGJwWFJWWVJ2V2hSN1R1cHlrdEZXMEM5LXFUMkZieWNkMVpsNktVc2psdXFpdGQ1bW84YkFYRFhtWTdfZHNsSlJCaE9Bbw==","email":"dey125r@gmail.com"}}}
    2 - crc start
        - crc start -p C:\Proyectos\Redhat\pull-secret.txt --log-level debug
    3 - oc login -u developer -p developer https://api.crc.testing:6443
        - oc login -u kubeadmin -p SMHy7-Rz8AL-JEU6j-VHcEE https://api.crc.testing:6443 --insecure-skip-tls-verify=true (sin certificado)

OTHER CONFIGS:
---------------
crc config set consent-telemetry yes
oc adm policy add-scc-to-user anyuid -z default ---> Dar permisos admin en el proyecto

HELM
-------------------------
winget install Helm.Helm

helm create microservice --> Create template
helm install microservice ./microservice -f values.yaml -n microservices --> install
helm template microservice .\microservice\ -f .\microservice\values.yam --debug -> Test yaml
helm install microservice .\microservice\ --dry-run --debug -> try install

  OPENSHIFT
--------------
crc status --log-level debug
crc delete
crc cleanup
crc console
   - crc console --credentials
crc config -> see configuration resources
crc config get <property> -> get configuration "memory" or "cpus"
crc config set <property> <number> -> set configuration "memory" or "cpus" 

KUBERNETES
-----------

GETS ----------------------
oc get all --> get all components (pods, deployments, images)
oc get node --> Acceder a los cluster del openshift (solo en admin)
oc get nodes -o wide --- > Lo mismo pero con mas info
oc get ns --> get namespace (solo admin)
oc get is --> get images stream (punteros a images reales)
oc get dc --> get deployment config (deployment config es de openshift y deployments son de kubernetes)
oc get bc --> get build CONFIGS
oc get builds --> get builds
oc get svc --> get services
oc get all -l app=<nombre app> --> get all component created into app
oc get all -o name -l app=blog --> get all names component created into 
oc get templates ---> get templates
oc get pv ---> get volumns
kubectl get pods == oc get pods --> get all pods
oc get pods -o wide --> get all pods con mas datos
oc get pod --all-namespaces  | grep Evicted --> Get all pods evicted

INFO ---------------------------
oc describe pods <nombre pods> ---> get information about pods
oc describe is <nombre image stream> ---> get information about image stream
oc describe dc <nombre deployment config>
oc describe nodes -> get information about system resources
oc logs <pod name> ---> get pod logs

PROYECT -------------------
oc new-project desa1 --> new project or namespace
oc get project desa1 -o yaml --> show status of the project
oc describe project desa1 --> get more details of the project
oc project <name-project --> change the project to use it

CREATE --------------
oc apply -f Proyecto.yaml --> apply yaml
oc create namespace desa4 --> Crear namespace con un projecto (se crea un proyecto con el namespace y tambien si creas un proyecto se crea un namespace)
oc project <nombre_project> -----> Cambiar de proyecto
oc create configmap cf1 --from-literal=usuario=usu1 --from-literal=password=secret--> Create config map with variables environment
oc create configmap postgres-cm --from-env-file postgres.properties --> create config map with file
oc create secret generic secret-cm --from-literal=usuario=usu1 --from-literal=password=secret --> Create secret

EDIT -----------------
oc set env pod/<nombre-pod> --list --> list var environment on pod
oc set env dc/<nombre-pod> --list --> list var environment on deployment config
oc set env dc/ejemplo-variables --overwrite <name-var>=<value-var> --> add/edit variable environment on deployment config
oc set env dc/ejemplo-variables --overwrite <name-var>- --> delete(-) variable environment on deployment config
oc edit dc <nombre-deploymentconfig> ---> change yaml deployment config

DELETE-------------------
oc delete all --all --> borrar todo dentro del proyecto
oc delete all -o name -l app=blog ---> delete all coponent of the application called "blog"
oc delete project desa3 --> delete proyect
oc get pod --all-namespaces  | awk '{if ($4=="Evicted") print "oc delete pod " $2 " -n " $1;}' | sh  -> DELETE ALL POD EVICTED


RUN ------------------------
oc run --generator=run-pod/v1 nginx --image=nginx --> Generar un pod con una imagen de nginx (version antigua)
oc run v1 nginx --image=nginx --> Generar un pod con una imagen de nginx (version nueva)

APPLICATION--------------------
oc new-app --as-deployment-config <nombre-usuario>/<nombre-imagen-dockerhub>

ROUTES-----------------
oc expose service/blog
oc port-forward pod/sql-server-778c55f77c-9f9fr 20468:1433 -->>> Open a port from pod to connect to DB

IMAGE-STREAM--------------------
oc import-image <name-imagen:version> --confirm ----> Crear un imagen stream a partir de una imagen de docker hub
oc import-image dey125r/imagen1 --scheduled=true --confirm ---> Importar una imagen para crear un image stream y que pregunte cada 15 min si es nueva
EJEMPLO: oc import-image mariadb:10.2 --confirm
oc tag <name-image-stream:version> <new-name-stream:new-version> --> Crear una tag con un nombre de una image stream
EJEMPLO: oc tag odoo:13 odoo:latest
EJEMPLO: oc tag docker.io/odoo:12 odoo:12
oc create imagestream docker-input --> Crear un image stream de la nada

BUILDS-------------------------
oc new-build <image>~<url_git image> --name=<name_build> ---> Crear un build config nuevo a partir de un codigo de git
EJEMPLO: oc new-build nodejs~https://github.com/sclorg/nodejs-ex.git --name=node2
oc start-build node2 ---> compilar de nuevo un build-config por si ha cambiado el codigo
oc start-build binary -from-dir fuente ---> actualizar un build sobre codigo fuente en local
oc cancel-build node-2-2 ---> Cancelar un build
oc delete bc node2 -> borrar un build config

DEPLOYMENT CONFIGS------------
oc rollout latest dc/php1 ---> relaunch the latest deployment config from php1
oc rollout status dc/php1 ---> get status from rollouts of php1
oc rollout history dc/php1 --> get history rollouts
oc rollout history dc/php1 --revision=1 ----> get details from an item history roullouts
oc rollout undo dc/php1 --to-revision=2 ----> deploy a deployment config before (revision=1)
oc scale dc/php1 --replicas=10 ---> escalar los pods de un deployment config con 10 pods

TEMPLATES --------
oc process redis-plantilla ---> see the content of the template
oc process redis-plantilla -p SERVIDOR=servidor3 ---> see the content of the template with params
oc process redis-plantilla -param-file=parametros.txt ---> see the content of the template with params from file
oc process redis-plantilla | oc apply -f - ---> process the templeate
oc get templates -n openshift --> get templates from openshift project
oc new-app --template=<name> --> new app from template using params on template
oc get bc,is,dc,service,route -o yaml > plantilla_web.yaml --> Generate template using existing objects

VOLUMNS -------------
oc get pv ---> get phisical volums (todos los namespaces)
oc get pvc --> get volumns from current project


OTHER --------------------------
oc rsh <name-container> ---> entrar en el contenedor de docker
echo <word> | base64 --> convertir palabra a base 64



EXAMPLES:
---------------------------

SQL SERVER Connection
-----------------------
oc port-forward svc/sql-server 1433:1433 -n microservices

MICROSERVICE Connection
-----------------------
oc port-forward svc/svc-microservice-maintenance 8080:8080 -n microservices

WEB EXAMPLE--------
oc new-app apasoft/blog --name=blog

WORDPRESS------------
oc new-app mysql:5.7 --name=mysql1 -e MYSQL_ROOT_PASSWORD=secret -e MYSQL_USER=usu1 -e MYSQL_PASSWORD=secret MYSQL_DATABASE=wordpress
oc new-app wordpress --name=wordpress1 -e WORDPRESS_DB_HOST=mysql1 -e WORDPRESS_DB_USER=usu1 -e WORDPRESS_DB_PASSWORD=secret -e WORDPRESS_DB_NAME=wordpress
oc expose service/wordpress1

PYTHON-----------
oc new-app --as-deployment-config python:3.5~https://github.com/apasofttraining/blog --name blog1 --strategy=source

ODOO-------------
files

CASANDRA----------
oc import-image cassandra:latest --from="docker.io/cassandra:latest" --confirm --> Crear una image stream from docker hub image real
oc new-app cassandra:latest --name=c1 ---> crear aplicacion de cassandra

MARIADB -----------
oc import-image mariadb:10.2 --confirm
oc new-app mariadb:10.2 --name=maria1 -e MYSQL_ROOT_PASSWORD=secret
oc get pod
oc rsh maria1-6996d8cfb6-qtgpf 
  mysql -u root -p
  PWD:secret
     show databases;

KEYCLOAK -------------
oc process -f https://raw.githubusercontent.com/keycloak/keycloak-quickstarts/latest/openshift/keycloak.yaml -p KEYCLOAK_ADMIN=admin -p KEYCLOAK_ADMIN_PASSWORD=admin -p NAMESPACE=keycloak | oc create -f -


Permisos de windows para levantar el CRC:
Enable-WindowsOptionalFeature -Online -FeatureName Microsoft-Hyper-V -All

The server is accessible via web console at:
  https://console-openshift-console.apps-crc.testing

Log in as administrator:
	Username: kubeadmin
  Password: vJSBz-cJ5LB-KQpdS-RfTxd

Log in as user:
  Username: developer
  Password: developer

Use the 'oc' command line interface:
  > @FOR /f "tokens=*" %i IN ('crc oc-env') DO @call %i
  > oc login -u developer https://api.crc.testing:6443

ERROR CE
En la página de error "La conexión no es privada", haz clic en cualquier lugar de la pantalla en blanco.
Escribe la frase: thisisunsafe (sin espacios, aunque no veas un campo de texto, Chrome lo detectará).

CADENA DE CONEXSION AZURE
Server=server-epad.database.windows.net,1433;Initial Catalog=SecurityDB;Persist Security Info=False;User ID=CloudSA337e4665;Password=Developer123?;MultipleActiveResultSets=False;Encrypt=True;TrustServerCertificate=False;Connection Timeout=30;
Server=server-epad.database.windows.net,1433;Initial Catalog=VehicleDB;Persist Security Info=False;User ID=CloudSA337e4665;Password=Developer123?;MultipleActiveResultSets=False;Encrypt=True;TrustServerCertificate=False;Connection Timeout=30;